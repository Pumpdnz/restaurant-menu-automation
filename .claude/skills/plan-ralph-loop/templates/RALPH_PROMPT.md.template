# Ralph Loop: {TASK_NAME}

## Configuration

| Setting | Value |
|---------|-------|
| Ralph Loop Directory | `{RALPH_LOOP_DIR}` |
| Project Directory | `{PROJECT_DIR}` |
| Frontend Directory | `UberEats-Image-Extractor` |
| Frontend Port | `{FRONTEND_PORT}` |
| Backend Port | `{BACKEND_PORT}` |
| Max Iterations | `{MAX_ITERATIONS}` |
| Test User Email | `{TEST_USER_EMAIL}` |
| Test User Password | `{TEST_USER_PASSWORD}` |

**IMPORTANT:** The dev server must be running BEFORE starting the Ralph Loop. The init.sh script only verifies - it does NOT start the server.

## Key Files (READ THESE FIRST)

| File | Path | Purpose |
|------|------|---------|
| Progress | `{RALPH_LOOP_DIR}/progress.txt` | Current iteration state |
| Features | `{RALPH_LOOP_DIR}/feature_list.json` | All features and pass status |
| Init Script | `{RALPH_LOOP_DIR}/init.sh` | Environment setup |

---

## Task Definition
{TASK_DEFINITION_FROM_INVESTIGATION}

## Technical Context
{TECHNICAL_CONTEXT_FROM_INVESTIGATION}

## Implementation Steps
{IMPLEMENTATION_STEPS_FROM_INVESTIGATION}

## Testing & Verification

### Method: {TESTING_METHOD}

{TESTING_METHOD_INSTRUCTIONS}

### Verification Checklist
{VERIFICATION_STEPS_FROM_SUCCESS_CRITERIA}

### Important: Do NOT Skip Verification

- For UI/frontend features: You MUST use Chrome DevTools MCP tools to verify the feature works
- Simply reading the code is NOT sufficient verification for UI features
- Use `mcp__chrome-devtools__take_screenshot` to document that features render correctly
- Use `mcp__chrome-devtools__list_console_messages` to check for JavaScript errors
- **Note:** Claude in Chrome tools do NOT work in spawned sessions - use Chrome DevTools MCP instead

---

## Session Start Procedure (MANDATORY)

Every iteration MUST begin with these steps:

1. `pwd` - Confirm working directory is `{PROJECT_DIR}`
2. Read `{RALPH_LOOP_DIR}/progress.txt` - Understand current state
3. Read `{RALPH_LOOP_DIR}/feature_list.json` - See all features and their status
4. `git log --oneline -10` - Review recent work
5. Run `bash {RALPH_LOOP_DIR}/init.sh` - Verify dev server is running on port {FRONTEND_PORT}
6. **CRITICAL: Run basic E2E test BEFORE any new work**
   - Navigate to `http://localhost:{FRONTEND_PORT}` and verify app loads
   - If baseline test fails, FIX IT FIRST
   - Do NOT proceed to new features with broken baseline
7. **Authenticate if required** (see Session Authentication below)
8. Choose highest-priority feature where `passes: false`
9. Begin implementation

---

## Session Authentication

Each browser session uses an isolated Chrome profile (`--isolated` flag) which means authentication state is NOT persisted between sessions. You must authenticate at the start of each session.

**Authentication Steps:**

1. After navigating to `http://localhost:{FRONTEND_PORT}`, check if you're on a login page
2. If login is required:
   - Enter test credentials:
     - Email: `{TEST_USER_EMAIL}`
     - Password: `{TEST_USER_PASSWORD}`
   - Click the sign-in button
   - Wait for the dashboard to fully load
3. Verify authentication succeeded by confirming dashboard elements are visible
4. Proceed with feature verification

**Why this is needed:** The `--isolated` MCP flag creates a fresh Chrome profile for each session, enabling parallel browser sessions without conflicts. The trade-off is that cookies and auth tokens are not preserved.

**Troubleshooting:**
- If login fails, check that the backend server is running on port {BACKEND_PORT}
- If credentials are rejected, verify the test user exists in the database
- Check browser console for authentication errors

---

## CRITICAL: One Feature Per Iteration

Work on EXACTLY ONE feature per iteration. Do not:
- Attempt to implement multiple features
- Make "while I'm here" additional changes
- Premature optimization
- Refactoring beyond the current feature

After completing ONE feature:
1. Verify it works (browser test at `http://localhost:{FRONTEND_PORT}`)
2. Update `{RALPH_LOOP_DIR}/feature_list.json`: set `passes: true`
3. Commit with descriptive message
4. Update `{RALPH_LOOP_DIR}/progress.txt`
5. Exit iteration

---

## Clean State on Exit (MANDATORY)

Before ending this iteration, ensure:
- [ ] No half-implemented code remains
- [ ] All changes are committed with descriptive messages
- [ ] No major bugs introduced
- [ ] Code is orderly and documented
- [ ] Next session can immediately start on next feature

---

## Iteration Workflow

1. Follow Session Start Procedure above
2. Implement ONE feature
3. Run verification (build + browser test at `http://localhost:{FRONTEND_PORT}`)
4. Update `{RALPH_LOOP_DIR}/feature_list.json`: change `passes: false` to `passes: true`
5. Log session ID: Run `/get-session-id` and include the returned ID in progress.txt
6. Update `{RALPH_LOOP_DIR}/progress.txt` with results (include session ID, feature worked on, outcome)
7. Git commit (see Git Commit Instructions below)
8. If ALL features pass: output `<promise>{TASK_NAME} COMPLETE</promise>`
9. Exit cleanly - the orchestrator will automatically spawn the next iteration

---

## Git Commit Instructions

**Important:** This project has code in a subdirectory and state files at the project root.

| Type | Location |
|------|----------|
| App code | `{PROJECT_DIR}/UberEats-Image-Extractor/` |
| State files | `{PROJECT_DIR}/{RALPH_LOOP_DIR}/` |

**Always commit from the project root directory:**

```bash
# Ensure you're at project root
cd {PROJECT_DIR}

# Stage app code changes (use relative path from project root)
git add UberEats-Image-Extractor/src/path/to/changed/file.tsx

# Stage state file updates
git add {RALPH_LOOP_DIR}/progress.txt
git add {RALPH_LOOP_DIR}/feature_list.json

# Commit all together
git commit -m "feat(Dashboard): Description of feature implemented"
```

**Do NOT:**
- Run `git add` from inside `UberEats-Image-Extractor/` when also committing state files
- Use relative paths like `../.claude/data/...` - always use paths relative to project root

---

## Completion Signal

When ALL features in `{RALPH_LOOP_DIR}/feature_list.json` have `passes: true`, output:

```
<promise>{TASK_NAME} COMPLETE</promise>
```

## Constraints
- Do NOT skip verification steps
- Do NOT mark frontend features as passing without browser verification
- Do NOT modify feature definitions in `{RALPH_LOOP_DIR}/feature_list.json` (only `passes` field)
- Do NOT exceed {MAX_ITERATIONS} iterations
- If stuck on same issue for 3+ iterations, document blocker clearly in `{RALPH_LOOP_DIR}/progress.txt`
