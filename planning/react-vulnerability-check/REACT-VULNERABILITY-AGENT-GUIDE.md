# React2Shell Vulnerability Agent Guide

## Quick Reference for AI Agents

This guide helps AI agents quickly assess and remediate React2Shell (CVE-2025-55182) vulnerability in any codebase.

---

## TL;DR Decision Tree

```
Does the project use React?
├── NO → NOT VULNERABLE (stop here)
└── YES → Check for React Server Components
    ├── Uses RSC (react-server-dom-*, 'use server', Next.js App Router)
    │   └── POTENTIALLY VULNERABLE → Check versions → Upgrade if needed
    └── Does NOT use RSC (client-side SPA, traditional SSR)
        └── NOT VULNERABLE (stop here)
```

---

## Vulnerability Summary

| Field | Value |
|-------|-------|
| **CVE** | CVE-2025-55182 |
| **Name** | React2Shell |
| **CVSS** | 10.0 (CRITICAL) |
| **Type** | Remote Code Execution (RCE) |
| **Affects** | React Server Components only |
| **Disclosed** | December 3, 2025 |
| **Exploited** | Since December 5, 2025 |

---

## Quick Check Commands

### 1. Check if RSC packages are installed

```bash
# Check package.json for RSC packages
grep -E "react-server-dom|@vitejs/plugin-rsc" package.json

# Check package-lock.json (more thorough)
grep -E "react-server-dom|@vitejs/plugin-rsc" package-lock.json

# Check node_modules
ls node_modules | grep -E "react-server-dom"
```

### 2. Check for RSC directives in code

```bash
# Search for server directives
grep -r "'use server'" --include="*.js" --include="*.jsx" --include="*.ts" --include="*.tsx" src/

# Search for client directives (indicates RSC architecture)
grep -r "'use client'" --include="*.js" --include="*.jsx" --include="*.ts" --include="*.tsx" src/
```

### 3. Check React version

```bash
# From package-lock.json
grep '"react":' package-lock.json | head -5

# From npm
npm list react
```

---

## Vulnerable Configurations

### React Packages (Vulnerable Versions)
| Package | Vulnerable | Patched |
|---------|------------|---------|
| react-server-dom-webpack | 19.0.0, 19.1.0, 19.1.1, 19.2.0 | 19.0.1, 19.1.2, 19.2.1 |
| react-server-dom-parcel | 19.0.0, 19.1.0, 19.1.1, 19.2.0 | 19.0.1, 19.1.2, 19.2.1 |
| react-server-dom-turbopack | 19.0.0, 19.1.0, 19.1.1, 19.2.0 | 19.0.1, 19.1.2, 19.2.1 |

### Next.js (Vulnerable Versions)
| Branch | Vulnerable | Patched |
|--------|------------|---------|
| 15.0.x | 15.0.0 - 15.0.4 | 15.0.5 |
| 15.1.x | 15.1.0 - 15.1.8 | 15.1.9 |
| 15.2.x | 15.2.0 - 15.2.5 | 15.2.6 |
| 15.3.x | 15.3.0 - 15.3.5 | 15.3.6 |
| 15.4.x | 15.4.0 - 15.4.7 | 15.4.8 |
| 15.5.x | 15.5.0 - 15.5.6 | 15.5.7 |
| 16.0.x | 16.0.0 - 16.0.6 | 16.0.7 |

---

## NOT Vulnerable Configurations

The following are **NOT vulnerable** to React2Shell:

1. **React 18 or earlier** - RSC not in stable release
2. **Client-side only React apps** - No server component execution
3. **Traditional SSR** (without RSC) - Uses different rendering path
4. **Vite + React** (without `@vitejs/plugin-rsc`) - Standard SPA
5. **Create React App** - Client-side only
6. **Next.js Pages Router** (without App Router) - No RSC

---

## Remediation Steps

### For Next.js Applications

```bash
# Automatic fix
npx fix-react2shell-next

# Manual fix
npm install next@[patched-version]
```

### For Other RSC Implementations

```bash
# Update React RSC packages
npm install react@19.1.2 react-dom@19.1.2 react-server-dom-webpack@19.1.2
```

### Post-Patching (If Previously Exposed)

If the application was online and unpatched between December 4-5, 2025:

1. **Rotate ALL secrets** - Environment variables, API keys, database credentials
2. **Check for compromise** - Review logs for suspicious POST requests
3. **Monitor for IOCs** - Cryptocurrency miners, unexpected outbound connections

---

## Assessment Template

When scanning a new codebase, use this template:

```markdown
## React2Shell Assessment for [PROJECT_NAME]

### Quick Facts
- React Version: [VERSION]
- Framework: [Next.js/Vite/CRA/Other]
- RSC Enabled: [YES/NO]

### Package Check
- [ ] react-server-dom-webpack: [NOT FOUND / VERSION]
- [ ] react-server-dom-parcel: [NOT FOUND / VERSION]
- [ ] react-server-dom-turbopack: [NOT FOUND / VERSION]
- [ ] @vitejs/plugin-rsc: [NOT FOUND / VERSION]

### Code Pattern Check
- [ ] 'use server' directives: [FOUND / NOT FOUND]
- [ ] 'use client' directives: [FOUND / NOT FOUND]
- [ ] RSC imports: [FOUND / NOT FOUND]

### Assessment
**Status**: [VULNERABLE / NOT VULNERABLE / NEEDS INVESTIGATION]

### Required Actions
[List actions or "None required"]
```

---

## Common Scenarios

### Scenario 1: Vite + React SPA
```
RSC Packages: None
RSC Directives: None
Assessment: NOT VULNERABLE
Action: None required
```

### Scenario 2: Next.js 15 with App Router
```
RSC Packages: Yes (bundled with Next.js)
RSC Directives: Likely present
Assessment: CHECK VERSION
Action: Upgrade to patched Next.js version
```

### Scenario 3: Next.js with Pages Router Only
```
RSC Packages: May be present but unused
RSC Directives: None
Assessment: LOW RISK (verify no App Router usage)
Action: Upgrade Next.js as precaution
```

### Scenario 4: React 18 Application
```
RSC Packages: Should not be present
RSC Directives: Should not work
Assessment: NOT VULNERABLE
Action: None required
```

---

## Official Resources

- [React Security Advisory](https://react.dev/blog/2025/12/03/critical-security-vulnerability-in-react-server-components)
- [Vercel React2Shell Bulletin](https://vercel.com/react2shell)
- [NVD CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
- [CISA KEV Entry](https://www.cisa.gov/known-exploited-vulnerabilities-catalog?field_cve=CVE-2025-55182)

---

## Agent Instructions

When asked to check for React2Shell vulnerability:

1. **First**: Run the quick check commands above
2. **If RSC packages found**: Check versions against vulnerable list
3. **If RSC code patterns found**: Confirm RSC is actively used
4. **Document findings**: Use the assessment template
5. **Recommend action**: Upgrade if vulnerable, or confirm safe if not

**Key Insight**: Most React applications are NOT vulnerable because they don't use React Server Components. The vulnerability is in the RSC infrastructure, not React itself.
